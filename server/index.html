<!doctype html>
<head>
  <meta charset="utf-8">

  <title>Socket.IO chat</title>

  <link rel="stylesheet" type="text/css" href="css/index.css"/>
  <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
  <script src="/socket.io/socket.io.js"></script>

</head>
<body>
    <div>

        <!-- <p class="right">right</p> -->
        <!-- <p class="left">left</p> -->
        <div class="bottom">
          <form action="">
            <input id="m" autocomplete="off" /><button id="send_button" type="button">Send</button>
        </form>
    </div>

</div>

<script>
    var socket = io.connect("http://localhost:8080/");

    var body = document.body
    var sendButton = document.getElementById('send_button');
    var form = document.getElementById('m');

    sendButton.addEventListener('click', function(){
        console.log('button click');

        var json = JSON.stringify({message : form.value});
        //send message
        socket.emit('c2s_message', json);
    });

    //receive message
    socket.on('s2c_message', function(message){
        var parse_message = JSON.parse(message);
        addMe(parse_message['message']);
        addAnotherUser(parse_message['message']);
    });

    function addMe(txt){
        var element = document.createElement('p');
        element.innerHTML = txt;
        element.className = "right";
        body.appendChild(element);
    }

    function addAnotherUser(txt){

        var element = document.createElement('p');
        element.innerHTML = txt;
        element.className = "left";
        body.appendChild(element);
    }


</script>

</body>
</html>